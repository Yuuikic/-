var LyricsFormer,LyricsLatter,albumimg,sourceImage,colorThief,color,songList,lyricLi,finalLyrics,songinfo=new Array(6),songid=new Array(6);function getinfo(){$(".bg-margin").css("background-color","rgba(73, 73, 73, 0.2)"),$(".songs").remove(),$(".meting").remove(),$("#BottomBorder").css("display","none"),$(".result").fadeOut("3000ms"),$(".result").fadeIn("3000ms"),$("#s-bgimg").fadeOut("slow"),$(".g-bgimg").fadeOut("slow"),$(".g-lyrics2 ul").fadeOut("slow"),$(".g-bgimg2").css("background-image","url()"),$(".lyrics ul").fadeOut("slow"),$(".title").fadeOut("slow"),$(".creator").fadeOut("slow"),$(".g-lyrics ul").fadeOut("slow"),null!=$("#search-form").val()&&""!=$("#search-form").val()&&$.ajax({url:"https://yuulyrics.vercel.app/search?keywords="+$("#search-form").val()+"&limit=5",type:"post",dataType:"json",xhrFields:{withCredentials:!0},success:function(e){songList=e.result.songs;for(let e=0;e<5;e++)songid[e]=songList[e].id,songinfo[e]=songList[e]}}).then((function(){for(let e=0;e<5;e++)$.ajax({url:"https://yuulyrics.vercel.app/song/detail?ids="+songid[e],type:"post",dataType:"json",xhrFields:{withCredentials:!0},success:function(s){songinfo[e].album.picUrl=s.songs[0].al.picUrl}}).then((function(){$div='<div class="songs container-fluid row"><img src='+songinfo[e].album.picUrl+`?param=500y500 alt="" class="img-circle col-xs-4" title="获取歌词" onclick="getansLyrics(${songid[e]})" name="${songinfo[e].name}" artist="${songinfo[e].artists[0].name}">`+`<p class="col-xs-8 text-center" tiltle="获取歌词" style="" onclick="getLyrics(${songinfo[e].id})">${songinfo[e].name}<br>${songinfo[e].artists[0].name}</p>\n                                </div>`,$(".result").append($div),$(".songs").fadeIn("3000ms")}))})).then((function(){}))}function getansLyrics(e){$(".meting").remove(),$.ajax({url:"https://yuulyrics.vercel.app/lyric?id="+e,type:"post",dataType:"json",xhrFields:{withCredentials:!0},success:function(s){if(""==s.lrc.lyric)alert("暂无歌词∠( ᐛ 」∠)＿");else if(0==s.qfy){let e=new RegExp(".*</li>","g"),t="<li>"+s.tlyric.lyric.replace(/\[.*\]/g,""),r="<li>"+s.lrc.lyric.replace(/\[.*\]/g,"");tlyricsLi=t.replaceAll("\n","</li>.<li>").match(e),lyricsLi=r.replaceAll("\n","</li>.<li>").match(e),tlyricsLi=tlyricsLi.toString(),lyricsLi=lyricsLi.toString(),sarray=lyricsLi.split("."),tarray=tlyricsLi.split(".");var i=new Array;for(let e=0;e<tarray.length;e++)i[e]=tarray[e];for(let e=0;e<sarray.length;e++)i[tarray.length+e]=sarray[e];finalLyrics=i.join(""),$("#geci").html(finalLyrics),$("#geci").attr("type","translate"),$(".lyrics ul").fadeIn("slow")}else{let e=new RegExp(".*</li>","g"),i="<li>"+s.lrc.lyric.replace(/\[.*\]/g,"");lyricLi=i.replaceAll("\n","</li><li>").match(e),$("#geci").html(lyricLi),$("#geci").attr("type","origin"),$(".lyrics ul").fadeIn("slow")}$("#music").append('<meting-js class="meting" server="netease" type="song" id="'+e+'""></meting-js>'),albumimg=$("[onclick*='"+e+"']").attr("src"),$("#s-bgimg").attr("src",albumimg),$(".g-bgimg").css("background-image","url("+albumimg+")"),$(".g-bgimg2").css("background-image","url("+albumimg+")"),$("#s-bgimg").fadeIn("slow"),$(".g-bgimg").fadeIn("slow"),$("#imgBottom").attr("src",albumimg),title=$("[onclick*='"+e+"']").attr("name"),artist=$("[onclick*='"+e+"']").attr("artist"),$(".songTitle").html(title),$(".singer").html(artist),$(".lyrics li").click((function(){$(this).hasClass("selected-lyrics")?$(this).removeClass("selected-lyrics"):$(this).addClass("selected-lyrics")}))}})}function getLyrics(e){$(".meting").remove(),$.ajax({url:"https://yuulyrics.vercel.app/lyric?id="+e,type:"post",dataType:"json",xhrFields:{withCredentials:!0},success:function(s){if(""==s.lrc.lyric)alert("暂无歌词∠( ᐛ 」∠)＿");else{let e=new RegExp(".*</li>","g"),i="<li>"+s.lrc.lyric.replace(/\[.*\]/g,"");lyricLi=i.replaceAll("\n","</li><li>").match(e),$("#geci").html(lyricLi),$("#geci").attr("type","origin"),$(".lyrics ul").fadeIn("slow")}$("#music").append('<meting-js class="meting" server="netease" type="song" id="'+e+'""></meting-js>'),albumimg=$("[onclick*='"+e+"']").attr("src"),$("#s-bgimg").attr("src",albumimg),$(".g-bgimg").css("background-image","url("+albumimg+")"),$(".g-bgimg2").css("background-image","url("+albumimg+")"),$("#s-bgimg").fadeIn("slow"),$(".g-bgimg").fadeIn("slow"),$("#imgBottom").attr("src",albumimg),title=$("[onclick*='"+e+"']").attr("name"),artist=$("[onclick*='"+e+"']").attr("artist"),$(".songTitle").html(title),$(".singer").html(artist),$(".lyrics li").click((function(){$(this).hasClass("selected-lyrics")?$(this).removeClass("selected-lyrics"):$(this).addClass("selected-lyrics")}))}})}function changeBackroundColor(e){"none"==$("#default").css("display")?alert("该样式不支持调整边框颜色"):($(".bg-margin").css("background-image","linear-gradient(to bottom right, rgb("+color[e]+"), rgb("+color[e+1]+"))"),$("#BottomBorder").css("background","rgba("+color[(e+1)%3]+" ,0.3)"))}function changeblur(){blurvalue=$("#blur").val(),$(".g-bgimg").css("filter","blur("+blurvalue+"px)"),$(".g-lyrics2").css("backdrop-filter","blur("+blurvalue+"px)")}function changeopacity(){"none"==$("#default").css("display")?alert("该样式不支持调整透明度"):(opacityvalue=$("#opacity").val(),$(".g-bgimg").css("opacity",opacityvalue))}$(document).ready((function(){$(".lyrics-hidden").css("width",$(".lyrics-select").css("width")),$(".g-bgimg2").css("height",$(".g-bgimg2").css("width")),$(".g-lyrics2").css("height",.95*parseFloat($(".g-bgimg2").css("width"))),$(".g-lyrics2").css("width",.7*parseFloat($(".g-bgimg2").css("width"))),$(".chevron-r").animate({left:"50px"},"100ms"),$(".chevron-r").animate({left:"0px"},"50ms"),$(".chevron-r").animate({left:"50px"},"100ms"),$(".chevron-r").animate({left:"0px"},"50ms"),$(".chevron-r").animate({left:"50px"},"100ms"),$(".chevron-r").animate({left:"0px"},"50ms"),$(".chevron-d").animate({top:"50px"},"100ms"),$(".chevron-d").animate({top:"0px"},"50ms"),$(".chevron-d").animate({top:"50px"},"100ms"),$(".chevron-d").animate({top:"0px"},"50ms"),$(".chevron-d").animate({top:"50px"},"100ms"),$(".chevron-d").animate({top:"0px"},"50ms")})),$(".chevron-r,.chevron-d").click((function(){$(".aplayer-lrc").addClass("aplayer-lrc-hide"),$(".g-lyrics-li").remove(),$(".g-lyrics-li").click((function(){$(this).removeClass("selected-lyrics")})),$($(".selected-lyrics").toArray().reverse()).each((function(e,s){$(s).removeClass("selected-lyrics").addClass("g-lyrics-li"),$("#glyrics ul").prepend(s),$("#glyrics ul").fadeIn("slow")})),"origin"==$("#geci").attr("type")?$("#geci").html(lyricLi):$("#geci").html(finalLyrics),sourceImage=document.getElementById("s-bgimg"),colorThief=new ColorThief,color=colorThief.getPalette(sourceImage,5),$(".bg-margin").css("background-image","linear-gradient(to bottom right, rgb("+color[0]+"), rgb("+color[1]+"))"),$("#BottomBorder").css("background","rgba("+color[1]+" ,0.3)"),$(".color1").css("background","rgb("+color[0]+")"),$(".color2").css("background","rgb("+color[1]+")"),$(".color3").css("background","rgb("+color[2]+")"),$(".color4").css("background","rgb("+color[3]+")"),$(".lyrics li").click((function(){$(this).hasClass("selected-lyrics")?$(this).removeClass("selected-lyrics"):$(this).addClass("selected-lyrics")})),$("#BottomBorder").css("display","block");var e=parseFloat($(".g-lyrics").css("height")),s=parseFloat($("#BottomBorder").css("height"));if(e+s<=440&&screen.width>970){let s=340-e;$("#BottomBorder").css("margin-top",s)}else if(e+s<=290&&screen.width<970){let s=190-e;$("#BottomBorder").css("margin-top",s)}else $("#BottomBorder").css("margin-top","0px");$(".bg-margin").css("height",e+s+60),$(".g-lyrics-hidden").css("height",e+s+60),$(".g-bgimg-hidden").css("height","100%"),$(".g-bgimg").css("height","100%")}));const gbgimg=document.getElementsByClassName("g-bgimg"),file=document.getElementById("file"),reader=new FileReader;function watchColorPicker(e){document.querySelectorAll("#glyrics").forEach((function(s){s.style.color=e.target.value}))}reader.addEventListener("load",(function(){$(".g-bgimg,.g-bgimg2").css("background-image",`url(${reader.result})`)}),!1),file.addEventListener("change",(function(){const e=this.files[0];e&&reader.readAsDataURL(e)}),!1),$("#uploadimg").click((function(){$("#file").click()})),$(".colorPickerbtn").click((function(){$("#colorPicker").click()})),colorPicker.addEventListener("input",glyrics,!1),colorPicker.addEventListener("change",watchColorPicker,!1);var save1=document.getElementById("default"),save2=document.getElementById("Photographic");function screenshot(){"none"==$("#default").css("display")?html2canvas(save2,{useCORS:!0,allowTaint:!0}).then((function(e){e.toBlob((function(e){window.saveAs(e,Date().slice(0,21)+".png")}))})):html2canvas(save1,{useCORS:!0,allowTaint:!0}).then((function(e){e.toBlob((function(e){window.saveAs(e,Date().slice(0,21)+".png")}))}))}function changeAd(){"none"==$("#default").css("display")?$(".copyright").html(""):($("#tag").html('<i class="fas fa-heart"></i>'),$("#tag").css("color","rgb(243, 103, 126)"),$("#tag").animate({"font-size":"1.7rem"},"fast"),$("#tag").animate({"font-size":"1.5rem"},"fast")),$("#picshot i").animate({"font-size":"2.5rem"},"fast"),$("#picshot i").animate({"font-size":"2rem"},"fast")}function changestyle(){"block"==$("#Photographic").css("display")?($("#default").css("display","block"),$("#Photographic").css("display","none")):($("#default").css("display","none"),$("#Photographic").css("display","block")),$("#BottomBorder").css("display","block");var e=parseFloat($(".g-lyrics").css("height")),s=parseFloat($("#BottomBorder").css("height"));if(e+s<=440&&screen.width>970){let s=340-e;$("#BottomBorder").css("margin-top",s)}else if(e+s<=290&&screen.width<970){let s=190-e;$("#BottomBorder").css("margin-top",s)}else $("#BottomBorder").css("margin-top","0px");$(".bg-margin").css("height",e+s+60),$(".g-lyrics-hidden").css("height",e+s+60),$(".g-bgimg-hidden").css("height","100%"),$(".g-bgimg").css("height","100%")}function generate(){$(".chevron-r").animate({left:"50px"},"100ms"),$(".chevron-r").animate({left:"0px"},"50ms"),$(".chevron-d").animate({top:"50px"},"100ms"),$(".chevron-d").animate({top:"0px"},"50ms")}